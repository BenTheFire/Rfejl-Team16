@page "/"
@using TicketMaster.Data
@using TicketMaster.Objects
@inject TicketMasterService TMS

<PageTitle>Index</PageTitle>

<body>
    @code 
    {
        public List<Movie> fetchedMovies = new();
        private string apiResult;
        protected override async Task OnInitializedAsync()
        {
            using (var httpClient = new HttpClient())
            {
                apiResult = await httpClient.GetStringAsync("https://");
            }
            FetchMovies();
            base.OnInitialized();
        }

        public void FetchMovies()
        {
            fetchedMovies = TMS.FetchMoviesBetween(1, 20);
        }
        public TimeOnly GetMovieLength(int timeInSeconds)
        {
            int hour = timeInSeconds / 3600;
            timeInSeconds %= 3600;
            int minute = timeInSeconds / 60;
            timeInSeconds %= 60;
            int second = timeInSeconds;

            return new(hour, minute, second);
        }

        public string HrefMovieLink(Movie movie) => "/movie_" + movie.ImdbId;
        public string ImgSrc(Movie movie) => "";
    }
    @foreach (var movie in fetchedMovies)
    {
        <NavLink href="@HrefMovieLink(movie)" class="text-decoration-none">
            <div class="card" style="width: 18rem;">
                <img src="@ImgSrc(movie)" class="card-img-top" alt="Card Image">
                <div class="card-body">
                    <h5 class="card-title">@movie.Title</h5>
                    <h5 class="card-title">@GetMovieLength(movie.LengthInSeconds).ToShortTimeString()</h5>
                </div>
            </div>
        </NavLink>
    }
</body>